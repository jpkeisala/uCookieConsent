!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.postscribe=e():t.postscribe=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(1),i=function(t){return t&&t.__esModule?t:{default:t}}(r);t.exports=i.default},function(t,e,n){"use strict";function r(){}function i(){var t=h.shift();if(t){var e=f.last(t);e.afterDequeue(),t.stream=o.apply(void 0,t),e.afterStreamStart()}}function o(t,e,n){function o(t){t=n.beforeWrite(t),y.write(t),n.afterWrite(t)}y=new c.default(t,n),y.id=d++,y.name=n.name||y.id,a.streams[y.name]=y;var u=t.ownerDocument,l={close:u.close,open:u.open,write:u.write,writeln:u.writeln};s(u,{close:r,open:r,write:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return o(e.join(""))},writeln:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return o(e.join("")+"\n")}});var f=y.win.onerror||r;return y.win.onerror=function(t,e,r){n.error({msg:t+" - "+e+": "+r}),f.apply(y.win,[t,e,r])},y.write(e,function(){s(u,l),y.win.onerror=f,n.done(),y=null,i()}),y}function a(t,e,n){if(f.isFunction(n))n={done:n};else if("clear"===n)return h=[],y=null,void(d=0);n=f.defaults(n,p),t=/^#/.test(t)?window.document.getElementById(t.substr(1)):t.jquery?t[0]:t;var o=[t,e,n];return t.postscribe={cancel:function(){o.stream?o.stream.abort():o[1]=r}},n.beforeEnqueue(o),h.push(o),y||i(),t.postscribe}e.__esModule=!0;var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.default=a;var u=n(2),c=function(t){return t&&t.__esModule?t:{default:t}}(u),l=n(4),f=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(l),p={afterAsync:r,afterDequeue:r,afterStreamStart:r,afterWrite:r,autoFix:!0,beforeEnqueue:r,beforeWriteToken:function(t){return t},beforeWrite:function(t){return t},done:r,error:function(t){throw new Error(t.msg)},releaseAsync:!1},d=0,h=[],y=null;s(a,{streams:{},queue:h,WriteStream:c.default})},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){var n=f+e,r=t.getAttribute(n);return l.existy(r)?String(r):r}function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=f+e;l.existy(n)&&""!==n?t.setAttribute(r,n):t.removeAttribute(r)}e.__esModule=!0;var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=n(3),u=function(t){return t&&t.__esModule?t:{default:t}}(s),c=n(4),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(c),f="data-ps-",p="ps-style",d="ps-script",h=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),this.root=e,this.options=n,this.doc=e.ownerDocument,this.win=this.doc.defaultView||this.doc.parentWindow,this.parser=new u.default("",{autoFix:n.autoFix}),this.actuals=[e],this.proxyHistory="",this.proxyRoot=this.doc.createElement(e.nodeName),this.scriptStack=[],this.writeQueue=[],o(this.proxyRoot,"proxyof",0)}return t.prototype.write=function(){var t;for((t=this.writeQueue).push.apply(t,arguments);!this.deferredRemote&&this.writeQueue.length;){var e=this.writeQueue.shift();l.isFunction(e)?this._callFunction(e):this._writeImpl(e)}},t.prototype._callFunction=function(t){var e={type:"function",value:t.name||t.toString()};this._onScriptStart(e),t.call(this.win,this.doc),this._onScriptDone(e)},t.prototype._writeImpl=function(t){this.parser.append(t);for(var e=void 0,n=void 0,r=void 0,i=[];(e=this.parser.readToken())&&!(n=l.isScript(e))&&!(r=l.isStyle(e));)(e=this.options.beforeWriteToken(e))&&i.push(e);i.length>0&&this._writeStaticTokens(i),n&&this._handleScriptToken(e),r&&this._handleStyleToken(e)},t.prototype._writeStaticTokens=function(t){var e=this._buildChunk(t);return e.actual?(e.html=this.proxyHistory+e.actual,this.proxyHistory+=e.proxy,this.proxyRoot.innerHTML=e.html,this._walkChunk(),e):null},t.prototype._buildChunk=function(t){for(var e=this.actuals.length,n=[],r=[],i=[],o=t.length,a=0;a<o;a++){var s=t[a],u=s.toString();if(n.push(u),s.attrs){if(!/^noscript$/i.test(s.tagName)){var c=e++;r.push(u.replace(/(\/?>)/," "+f+"id="+c+" $1")),s.attrs.id!==d&&s.attrs.id!==p&&i.push("atomicTag"===s.type?"":"<"+s.tagName+" "+f+"proxyof="+c+(s.unary?" />":">"))}}else r.push(u),i.push("endTag"===s.type?u:"")}return{tokens:t,raw:n.join(""),actual:r.join(""),proxy:i.join("")}},t.prototype._walkChunk=function(){for(var t=void 0,e=[this.proxyRoot];l.existy(t=e.shift());){var n=1===t.nodeType;if(!(n&&i(t,"proxyof"))){n&&(this.actuals[i(t,"id")]=t,o(t,"id"));var r=t.parentNode&&i(t.parentNode,"proxyof");r&&this.actuals[r].appendChild(t)}e.unshift.apply(e,l.toArray(t.childNodes))}},t.prototype._handleScriptToken=function(t){var e=this,n=this.parser.clear();n&&this.writeQueue.unshift(n),t.src=t.attrs.src||t.attrs.SRC,(t=this.options.beforeWriteToken(t))&&(t.src&&this.scriptStack.length?this.deferredRemote=t:this._onScriptStart(t),this._writeScriptToken(t,function(){e._onScriptDone(t)}))},t.prototype._handleStyleToken=function(t){var e=this.parser.clear();e&&this.writeQueue.unshift(e),t.type=t.attrs.type||t.attrs.TYPE||"text/css",t=this.options.beforeWriteToken(t),t&&this._writeStyleToken(t),e&&this.write()},t.prototype._writeStyleToken=function(t){var e=this._buildStyle(t);this._insertCursor(e,p),t.content&&(e.styleSheet&&!e.sheet?e.styleSheet.cssText=t.content:e.appendChild(this.doc.createTextNode(t.content)))},t.prototype._buildStyle=function(t){var e=this.doc.createElement(t.tagName);return e.setAttribute("type",t.type),l.eachKey(t.attrs,function(t,n){e.setAttribute(t,n)}),e},t.prototype._insertCursor=function(t,e){this._writeImpl('<span id="'+e+'"/>');var n=this.doc.getElementById(e);n&&n.parentNode.replaceChild(t,n)},t.prototype._onScriptStart=function(t){t.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(t)},t.prototype._onScriptDone=function(t){return t!==this.scriptStack[0]?void this.options.error({msg:"Bad script nesting or script finished twice"}):(this.scriptStack.shift(),this.write.apply(this,t.outerWrites),void(!this.scriptStack.length&&this.deferredRemote&&(this._onScriptStart(this.deferredRemote),this.deferredRemote=null)))},t.prototype._writeScriptToken=function(t,e){var n=this._buildScript(t),r=this._shouldRelease(n),i=this.options.afterAsync;t.src&&(n.src=t.src,this._scriptLoadHandler(n,r?i:function(){e(),i()}));try{this._insertCursor(n,d),n.src&&!r||e()}catch(t){this.options.error(t),e()}},t.prototype._buildScript=function(t){var e=this.doc.createElement(t.tagName);return l.eachKey(t.attrs,function(t,n){e.setAttribute(t,n)}),t.content&&(e.text=t.content),e},t.prototype._scriptLoadHandler=function(t,e){function n(){t=t.onload=t.onreadystatechange=t.onerror=null}function r(){n(),null!=e&&e(),e=null}function i(t){n(),s(t),null!=e&&e(),e=null}function o(t,e){var n=t["on"+e];null!=n&&(t["_on"+e]=n)}var s=this.options.error;o(t,"load"),o(t,"error"),a(t,{onload:function(){if(t._onload)try{t._onload.apply(this,Array.prototype.slice.call(arguments,0))}catch(e){i({msg:"onload handler failed "+e+" @ "+t.src})}r()},onerror:function(){if(t._onerror)try{t._onerror.apply(this,Array.prototype.slice.call(arguments,0))}catch(e){return void i({msg:"onerror handler failed "+e+" @ "+t.src})}i({msg:"remote script failed "+t.src})},onreadystatechange:function(){/^(loaded|complete)$/.test(t.readyState)&&r()}})},t.prototype._shouldRelease=function(t){return!/^script$/i.test(t.nodeName)||!!(this.options.releaseAsync&&t.src&&t.hasAttribute("async"))},t}();e.default=h},function(t,e,n){!function(e,n){t.exports=function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(1),i=function(t){return t&&t.__esModule?t:{default:t}}(r);t.exports=i.default},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var o=n(2),a=r(o),s=n(3),u=r(s),c=n(6),l=function(t){return t&&t.__esModule?t:{default:t}}(c),f=n(5),p={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},d=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,t),this.stream=n;var o=!1,s={};for(var u in a)a.hasOwnProperty(u)&&(r.autoFix&&(s[u+"Fix"]=!0),o=o||s[u+"Fix"]);o?(this._readToken=(0,l.default)(this,s,function(){return e._readTokenImpl()}),this._peekToken=(0,l.default)(this,s,function(){return e._peekTokenImpl()})):(this._readToken=this._readTokenImpl,this._peekToken=this._peekTokenImpl)}return t.prototype.append=function(t){this.stream+=t},t.prototype.prepend=function(t){this.stream=t+this.stream},t.prototype._readTokenImpl=function(){var t=this._peekTokenImpl();if(t)return this.stream=this.stream.slice(t.length),t},t.prototype._peekTokenImpl=function(){for(var t in p)if(p.hasOwnProperty(t)&&p[t].test(this.stream)){var e=u[t](this.stream);if(e)return"startTag"===e.type&&/script|style/i.test(e.tagName)?null:(e.text=this.stream.substr(0,e.length),e)}},t.prototype.peekToken=function(){return this._peekToken()},t.prototype.readToken=function(){return this._readToken()},t.prototype.readTokens=function(t){for(var e=void 0;e=this.readToken();)if(t[e.type]&&!1===t[e.type](e))return},t.prototype.clear=function(){var t=this.stream;return this.stream="",t},t.prototype.rest=function(){return this.stream},t}();e.default=d,d.tokenToString=function(t){return t.toString()},d.escapeAttributes=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=(0,f.escapeQuotes)(t[n],null));return e},d.supports=a;for(var h in a)a.hasOwnProperty(h)&&(d.browserHasFlaw=d.browserHasFlaw||!a[h]&&h)},function(t,e){"use strict";e.__esModule=!0;var n=!1,r=!1,i=window.document.createElement("div");try{var o="<P><I></P></I>";i.innerHTML=o,e.tagSoup=n=i.innerHTML!==o}catch(t){e.tagSoup=n=!1}try{i.innerHTML="<P><i><P></P></i></P>",e.selfClose=r=2===i.childNodes.length}catch(t){e.selfClose=r=!1}i=null,e.tagSoup=n,e.selfClose=r},function(t,e,n){"use strict";function r(t){var e=t.indexOf("--\x3e");if(e>=0)return new c.CommentToken(t.substr(4,e-1),e+3)}function i(t){var e=t.indexOf("<");return new c.CharsToken(e>=0?e:t.length)}function o(t){if(-1!==t.indexOf(">")){var e=t.match(l.startTag);if(e){var n=function(){var t={},n={},r=e[2];return e[2].replace(l.attr,function(e,i){arguments[2]||arguments[3]||arguments[4]||arguments[5]?arguments[5]?(t[arguments[5]]="",n[arguments[5]]=!0):t[i]=arguments[2]||arguments[3]||arguments[4]||l.fillAttr.test(i)&&i||"":t[i]="",r=r.replace(e,"")}),{v:new c.StartTagToken(e[1],e[0].length,t,n,!!e[3],r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))}}();if("object"===(void 0===n?"undefined":u(n)))return n.v}}}function a(t){var e=o(t);if(e){var n=t.slice(e.length);if(n.match(new RegExp("</\\s*"+e.tagName+"\\s*>","i"))){var r=n.match(new RegExp("([\\s\\S]*?)</\\s*"+e.tagName+"\\s*>","i"));if(r)return new c.AtomicTagToken(e.tagName,r[0].length+e.length,e.attrs,e.booleanAttrs,r[1])}}}function s(t){var e=t.match(l.endTag);if(e)return new c.EndTagToken(e[1],e[0].length)}e.__esModule=!0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.comment=r,e.chars=i,e.startTag=o,e.atomicTag=a,e.endTag=s;var c=n(4),l={startTag:/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag:/^<\/([\-A-Za-z0-9_]+)[^>]*>/,attr:/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,fillAttr:/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e.EndTagToken=e.AtomicTagToken=e.StartTagToken=e.TagToken=e.CharsToken=e.CommentToken=e.Token=void 0;var i=n(5),o=(e.Token=function t(e,n){r(this,t),this.type=e,this.length=n,this.text=""},e.CommentToken=function(){function t(e,n){r(this,t),this.type="comment",this.length=n||(e?e.length:0),this.text="",this.content=e}return t.prototype.toString=function(){return"\x3c!--"+this.content},t}(),e.CharsToken=function(){function t(e){r(this,t),this.type="chars",this.length=e,this.text=""}return t.prototype.toString=function(){return this.text},t}(),e.TagToken=function(){function t(e,n,i,o,a){r(this,t),this.type=e,this.length=i,this.text="",this.tagName=n,this.attrs=o,this.booleanAttrs=a,this.unary=!1,this.html5Unary=!1}return t.formatTag=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="<"+t.tagName;for(var r in t.attrs)if(t.attrs.hasOwnProperty(r)){n+=" "+r;var o=t.attrs[r];void 0!==t.booleanAttrs&&void 0!==t.booleanAttrs[r]||(n+='="'+(0,i.escapeQuotes)(o)+'"')}return t.rest&&(n+=" "+t.rest),n+=t.unary&&!t.html5Unary?"/>":">",void 0!==e&&null!==e&&(n+=e+"</"+t.tagName+">"),n},t}());e.StartTagToken=function(){function t(e,n,i,o,a,s){r(this,t),this.type="startTag",this.length=n,this.text="",this.tagName=e,this.attrs=i,this.booleanAttrs=o,this.html5Unary=!1,this.unary=a,this.rest=s}return t.prototype.toString=function(){return o.formatTag(this)},t}(),e.AtomicTagToken=function(){function t(e,n,i,o,a){r(this,t),this.type="atomicTag",this.length=n,this.text="",this.tagName=e,this.attrs=i,this.booleanAttrs=o,this.unary=!1,this.html5Unary=!1,this.content=a}return t.prototype.toString=function(){return o.formatTag(this,this.content)},t}(),e.EndTagToken=function(){function t(e,n){r(this,t),this.type="endTag",this.length=n,this.text="",this.tagName=e}return t.prototype.toString=function(){return"</"+this.tagName+">"},t}()},function(t,e){"use strict";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t?t.replace(/([^"]*)"/g,function(t,e){return/\\/.test(e)?e+'"':e+'\\"'}):e}e.__esModule=!0,e.escapeQuotes=n},function(t,e){"use strict";function n(t){return t&&"startTag"===t.type&&(t.unary=s.test(t.tagName)||t.unary,t.html5Unary=!/\/>$/.test(t.text)),t}function r(t,e){var r=t.stream,i=n(e());return t.stream=r,i}function i(t,e){var n=e.pop();t.prepend("</"+n.tagName+">")}function o(){var t=[];return t.last=function(){return this[this.length-1]},t.lastTagNameEq=function(t){var e=this.last();return e&&e.tagName&&e.tagName.toUpperCase()===t.toUpperCase()},t.containsTagName=function(t){for(var e,n=0;e=this[n];n++)if(e.tagName===t)return!0;return!1},t}function a(t,e,a){function s(){var e=r(t,a);e&&l[e.type]&&l[e.type](e)}var c=o(),l={startTag:function(n){var r=n.tagName;"TR"===r.toUpperCase()&&c.lastTagNameEq("TABLE")?(t.prepend("<TBODY>"),s()):e.selfCloseFix&&u.test(r)&&c.containsTagName(r)?c.lastTagNameEq(r)?i(t,c):(t.prepend("</"+n.tagName+">"),s()):n.unary||c.push(n)},endTag:function(n){c.last()?e.tagSoupFix&&!c.lastTagNameEq(n.tagName)?i(t,c):c.pop():e.tagSoupFix&&(a(),s())}};return function(){return s(),n(a())}}e.__esModule=!0,e.default=a;var s=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,u=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i}])}()}()},function(t,e){"use strict";function n(t){return void 0!==t&&null!==t}function r(t){return"function"==typeof t}function i(t,e,n){var r=void 0,i=t&&t.length||0;for(r=0;r<i;r++)e.call(n,t[r],r)}function o(t,e,n){for(var r in t)t.hasOwnProperty(r)&&e.call(n,r,t[r])}function a(t,e){return t=t||{},o(e,function(e,r){n(t[e])||(t[e]=r)}),t}function s(t){try{return Array.prototype.slice.call(t)}catch(n){var e=function(){var e=[];return i(t,function(t){e.push(t)}),{v:e}}();if("object"===(void 0===e?"undefined":p(e)))return e.v}}function u(t){return t[t.length-1]}function c(t,e){return!(!t||"startTag"!==t.type&&"atomicTag"!==t.type||!("tagName"in t)||!~t.tagName.toLowerCase().indexOf(e))}function l(t){return c(t,"script")}function f(t){return c(t,"style")}e.__esModule=!0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.existy=n,e.isFunction=r,e.each=i,e.eachKey=o,e.defaults=a,e.toArray=s,e.last=u,e.isTag=c,e.isScript=l,e.isStyle=f}])}),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(n){return e(t,n)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=e(t,require("jquery")):t.lity=e(t,t.jQuery||t.Zepto)}("undefined"!=typeof window?window:this,function(t,e){"use strict";function n(t){var e=k();return j&&t.length?(t.one(j,e.resolve),setTimeout(e.resolve,500)):e.resolve(),e.promise()}function r(t,n,r){if(1===arguments.length)return e.extend({},t);if("string"==typeof n){if(void 0===r)return void 0===t[n]?null:t[n];t[n]=r}else e.extend(t,n);return this}function i(t){var e=t.indexOf("?");e>-1&&(t=t.substr(e+1));for(var n,r=decodeURI(t.split("#")[0]).split("&"),i={},o=0,a=r.length;o<a;o++)r[o]&&(n=r[o].split("="),i[n[0]]=n[1]);return i}function o(t,n){if(!n)return t;if("string"===e.type(n)&&(n=i(n)),t.indexOf("?")>-1){var r=t.split("?");t=r.shift(),n=e.extend({},i(r[0]),n)}return t+"?"+e.param(n)}function a(t,e){var n=t.indexOf("#");return-1===n?e:(n>0&&(t=t.substr(n)),e+t)}function s(t,e,n,r){return e&&e.element().addClass("lity-iframe"),n&&(t=o(t,n)),r&&(t=a(r,t)),'<div class="lity-iframe-container"><iframe frameborder="0" allowfullscreen allow="autoplay; fullscreen" src="'+t+'"/></div>'}function u(t){return e('<span class="lity-error"/>').append(t)}function c(t,n){var r=n.opener()&&n.opener().data("lity-desc")||"Image with no description",i=e('<img src="'+t+'" alt="'+r+'"/>'),o=k(),a=function(){o.reject(u("Failed loading image"))};return i.on("load",function(){if(0===this.naturalWidth)return a();o.resolve(i)}).on("error",a),o.promise()}function l(t,n){var r,i,o;try{r=e(t)}catch(t){return!1}return!!r.length&&(i=e('<i style="display:none !important"/>'),o=r.hasClass("lity-hide"),n.element().one("lity:remove",function(){i.before(r).remove(),o&&!r.closest(".lity-content").length&&r.addClass("lity-hide")}),r.removeClass("lity-hide").after(i))}function f(t,e){return s(t,e)}function p(){return _.documentElement.clientHeight?_.documentElement.clientHeight:Math.round(x.height())}function d(t){var e=g();e&&(27===t.keyCode&&e.options("esc")&&e.close(),9===t.keyCode&&h(t,e))}function h(t,e){var n=e.element().find(E),r=n.index(_.activeElement);t.shiftKey&&r<=0?(n.get(n.length-1).focus(),t.preventDefault()):t.shiftKey||r!==n.length-1||(n.get(0).focus(),t.preventDefault())}function y(){e.each(A,function(t,e){e.resize()})}function m(t){1===A.unshift(t)&&(S.addClass("lity-active"),x.on({resize:y,keydown:d})),e("body > *").not(t.element()).addClass("lity-hidden").each(function(){var t=e(this);void 0===t.data(N)&&t.data(N,t.attr(C)||null)}).attr(C,"true")}function v(t){var n;t.element().attr(C,"true"),1===A.length&&(S.removeClass("lity-active"),x.off({resize:y,keydown:d})),A=e.grep(A,function(e){return t!==e}),n=A.length?A[0].element():e(".lity-hidden"),n.removeClass("lity-hidden").each(function(){var t=e(this),n=t.data(N);n?t.attr(C,n):t.removeAttr(C),t.removeData(N)})}function g(){return 0===A.length?null:A[0]}function T(t,n,r,i){var o,a="inline",s=e.extend({},r);return i&&s[i]?(o=s[i](t,n),a=i):(e.each(["inline","iframe"],function(t,e){delete s[e],s[e]=r[e]}),e.each(s,function(e,r){return!r||(!(!r.test||r.test(t,n))||(o=r(t,n),!1!==o?(a=e,!1):void 0))})),{handler:a,content:o||""}}function w(t,i,o,a){function s(t){l=e(t).css("max-height",p()+"px"),c.find(".lity-loader").each(function(){var t=e(this);n(t).always(function(){t.remove()})}),c.removeClass("lity-loading").find(".lity-content").empty().append(l),d=!0,l.trigger("lity:ready",[f])}var u,c,l,f=this,d=!1,h=!1;i=e.extend({},O,i),c=e(i.template),f.element=function(){return c},f.opener=function(){return o},f.content=function(){return l},f.options=e.proxy(r,f,i),f.handlers=e.proxy(r,f,i.handlers),f.resize=function(){d&&!h&&l.css("max-height",p()+"px").trigger("lity:resize",[f])},f.close=function(){if(d&&!h){h=!0,v(f);var t=k();if(a&&(_.activeElement===c[0]||e.contains(c[0],_.activeElement)))try{a.focus()}catch(t){}return l.trigger("lity:close",[f]),c.removeClass("lity-opened").addClass("lity-closed"),n(l.add(c)).always(function(){l.trigger("lity:remove",[f]),c.remove(),c=void 0,t.resolve()}),t.promise()}},u=T(t,f,i.handlers,i.handler),c.attr(C,"false").addClass("lity-loading lity-opened lity-"+u.handler).appendTo("body").focus().on("click","[data-lity-close]",function(t){e(t.target).is("[data-lity-close]")&&f.close()}).trigger("lity:open",[f]),m(f),e.when(u.content).always(s)}function b(t,n,r){t.preventDefault?(t.preventDefault(),r=e(this),t=r.data("lity-target")||r.attr("href")||r.attr("src")):r=e(r);var i=new w(t,e.extend({},r.data("lity-options")||r.data("lity"),n),r,_.activeElement);if(!t.preventDefault)return i}var _=t.document,x=e(t),k=e.Deferred,S=e("html"),A=[],C="aria-hidden",N="lity-"+C,E='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])',O={esc:!0,handler:null,handlers:{image:c,inline:l,iframe:f},template:'<div class="lity" role="dialog" aria-label="Dialog Window (Press escape to close)" tabindex="-1"><div class="lity-wrap" data-lity-close role="document"><div class="lity-loader" aria-hidden="true">Loading...</div><div class="lity-container"><div class="lity-content"></div><button class="lity-close" type="button" aria-label="Close (Press escape to close)" data-lity-close>&times;</button></div></div></div>'},M=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i,j=function(){var t=_.createElement("div"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return e[n];return!1}();return c.test=function(t){return M.test(t)},b.version="3.0.0-dev",b.options=e.proxy(r,b,O),b.handlers=e.proxy(r,b,O.handlers),b.current=g,b.iframe=s,e(_).on("click.lity","[data-lity]",b),b});